# ドキュメント管理システム 要件定義書

## 1. プロジェクト概要

### 1.1 背景・課題

- 歴史的経緯により組織構造が複数回変更され、文書のフォルダパスが不統一
- 複数の命名規則が混在し、文書の所在管理が困難
- 人員の部署移動履歴により、過去文書へのアクセス権限管理が複雑
- 文書の存在確認（本体・承認書）の手動確認が非効率

### 1.2 目的

組織変遷と人員異動を考慮した統合的なドキュメントフォルダパス管理システムの構築により、効率的な文書管理と検索を実現する。

### 1.3 スコープ

- **対象**: ネットワークドライブ上の文書フォルダパス管理
- **除外**: 文書ファイル自体の内容管理・バージョン管理
- **期間**: 開発期間3ヶ月、段階的リリース

## 2. 機能要件

### 2.1 文書基盤管理機能

| ID   | 要件               | EARS形式                                                                                                                      |
| ---- | ------------------ | ----------------------------------------------------------------------------------------------------------------------------- |
| F001 | 文書番号生成       | システムは文書種類(A,B,C,D,Q,R,X)・部(1文字)・課(1文字)・年月・連番が入力された場合、一意の文書番号(例:CTA-2508001)を生成する |
| F002 | 版管理             | システムは既存文書番号に対して改訂版(r1,r2...)またはドラフト版(d1,d2...)の番号を付与する                                      |
| F003 | フォルダパス紐付け | システムは各文書番号に対してネットワークドライブのフォルダパス(\\server\share\folder\)を関連付けて保存する                    |
| F004 | パス履歴管理       | システムは組織改編等によるフォルダパス変更時、旧パスと新パスの両方を履歴として保持する                                        |

### 2.2 組織・人員管理機能

| ID   | 要件         | EARS形式                                                                         |
| ---- | ------------ | -------------------------------------------------------------------------------- |
| F005 | 組織構造管理 | システムは部・課の階層構造と組織改編履歴を時系列で管理する                       |
| F006 | 人員異動履歴 | システムは各人員の部署所属履歴（開始日・終了日）を管理し、兼務・出向にも対応する |
| F007 | AD連携       | システムはActive Directoryと連携し、社員番号ベースでの人員管理を行う             |
| F008 | 権限継承検索 | システムは利用者の過去所属部署の文書も検索対象に含める                           |

### 2.3 ファイル存在確認機能

| ID   | 要件         | EARS形式                                                                            |
| ---- | ------------ | ----------------------------------------------------------------------------------- |
| F009 | 文書存在確認 | システムは月次で各文書番号に対応するフォルダパスの存在を確認する                    |
| F010 | 承認書確認   | システムはA・B文書について、承認書ファイル([文書番号]-審査承認.pdf)の存在を確認する |
| F011 | 確認除外設定 | システムは指定された年月日以前または特定部署の文書について存在確認を除外する        |
| F012 | エラー通知   | システムはパス不存在・ファイル不存在時にメールまたはTeams通知を送信する             |

### 2.4 検索・閲覧機能

| ID   | 要件         | EARS形式                                                                         |
| ---- | ------------ | -------------------------------------------------------------------------------- |
| F013 | 多条件検索   | システムは文書種別・製番・タイトル・作成者での組み合わせ検索を提供する           |
| F014 | 履歴検索     | システムは過去の組織所属履歴を考慮した文書検索を実行する                         |
| F015 | 機密制御     | システムは利用者の権限に応じて機密レベル（社内外×重要度1,2）の文書表示を制御する |
| F016 | パス表示切替 | システムは機密レベルに応じてフォルダパスの表示・非表示を制御する                 |

### 2.5 業務従事者管理機能

| ID   | 要件             | EARS形式                                                                       |
| ---- | ---------------- | ------------------------------------------------------------------------------ |
| F021 | 業務従事者登録   | システムは各業務に従事する人員を役割・参加レベル・期間と共に登録する           |
| F022 | 業務メンバー管理 | システムは業務従事者の追加・変更・履歴管理を時系列で記録する                   |
| F023 | 回覧候補提案     | システムは文書の業務番号から従事者を自動抽出し、回覧候補として提案する         |
| F024 | 外部連絡先管理   | システムは業務に関連する外部連絡先（顧客・協力会社）を管理し回覧対象とする     |

### 2.6 高度検索機能

| ID   | 要件               | EARS形式                                                                     |
| ---- | ------------------ | ---------------------------------------------------------------------------- |
| F025 | 社員高度検索       | システムは名前・部署・役職・業務従事履歴での複合条件による社員検索を提供する |
| F026 | 業務高度検索       | システムは業務番号・名前・期間・従事者・顧客での複合条件による業務検索を提供する |
| F027 | オートコンプリート | システムは検索入力時に部分文字列マッチングによる候補を動的に表示する         |
| F028 | 段階的絞り込み     | システムは部署→課→個人の階層的選択による段階的絞り込み機能を提供する         |
| F029 | 検索履歴保存       | システムは利用者の検索条件をお気に入りとして保存・再利用機能を提供する       |

### 2.7 柔軟回覧機能

| ID   | 要件             | EARS形式                                                                     |
| ---- | ---------------- | ---------------------------------------------------------------------------- |
| F030 | 階層化回覧候補   | システムは業務従事者・部署メンバー・全社員・外部連絡先の階層的候補を提案する |
| F031 | 一括回覧設定     | システムは提案候補からの一括選択・個別除外による効率的な回覧設定を提供する   |
| F032 | 回覧履歴活用     | システムは過去の回覧履歴から類似パターンを学習し候補として提案する           |
| F033 | 外部回覧対応     | システムは外部メールアドレスへの直接回覧とステータス管理を提供する           |

### 2.8 データ移行・名寄せ機能

| ID   | 要件           | EARS形式                                                                       |
| ---- | -------------- | ------------------------------------------------------------------------------ |
| F034 | CSV取込み      | システムは既存文書情報のCSVファイルを取り込み、データベースに格納する          |
| F035 | 業務番号名寄せ | システムは同一業務番号の重複使用を検出し、年度・期間を考慮した一意性を確保する |
| F036 | 作成者名寄せ   | システムは作成者名の表記ゆれを検出し、社員番号による統合を提案する             |
| F037 | 顧客名寄せ     | システムは顧客名の表記ゆれを検出し、統合候補を提示する                         |

## 3. 非機能要件

### 3.1 性能要件

| 項目             | 要件                        | 測定方法           |
| ---------------- | --------------------------- | ------------------ |
| 応答時間         | 検索応答2秒以内             | 平均応答時間測定   |
| 同時接続数       | 最大10ユーザー              | 負荷テスト         |
| データ容量       | 10年分の文書情報（約5万件） | ストレージ容量計測 |
| ファイル確認性能 | 1万件/時間の存在確認        | バッチ処理時間測定 |

### 3.2 可用性要件

| 項目       | 要件                        | 対策                   |
| ---------- | --------------------------- | ---------------------- |
| 稼働時間   | 平日8-18時 99%稼働          | 冗長化・監視           |
| 復旧時間   | 障害発生から4時間以内復旧   | バックアップ・復旧手順 |
| データ保全 | 日次バックアップ、1ヶ月保持 | 自動バックアップ       |

### 3.3 セキュリティ要件

| 項目       | 要件                   | 実装方針             |
| ---------- | ---------------------- | -------------------- |
| 認証       | AD統合認証             | Windows認証          |
| 認可       | 役割ベースアクセス制御 | 部署・機密レベル対応 |
| 通信暗号化 | HTTPS通信              | TLS1.3以上           |
| 監査ログ   | アクセス・変更ログ記録 | ログ管理機能         |

### 3.4 保守性要件

| 項目         | 要件                     | 対策               |
| ------------ | ------------------------ | ------------------ |
| コード品質   | テストカバレッジ80%以上  | 単体・結合テスト   |
| ドキュメント | API仕様・運用手順書整備  | 自動生成・更新     |
| 監視         | システム状態・エラー監視 | ログ監視・アラート |

## 4. 制約・前提条件

### 4.1 技術制約

| 項目             | 制約内容                 | 影響             |
| ---------------- | ------------------------ | ---------------- |
| プラットフォーム | Windows Server環境       | 技術選定制限     |
| ネットワーク     | 既存ファイルサーバー利用 | アクセス方式制限 |
| 認証基盤         | Active Directory必須     | 認証方式固定     |
| データベース     | RDB推奨                  | SQLLite3選択     |

### 4.2 運用制約

| 項目             | 制約内容         | 対応策           |
| ---------------- | ---------------- | ---------------- |
| メンテナンス時間 | 平日19-22時のみ  | 自動化・短時間化 |
| 利用者教育       | 最小限の操作研修 | 直感的UI設計     |
| データ移行期間   | 1ヶ月以内完了    | 段階的移行計画   |

### 4.3 データ制約

| 項目           | 制約内容           | 対策               |
| -------------- | ------------------ | ------------------ |
| 既存データ品質 | 表記ゆれ・重複多数 | 名寄せ機能実装     |
| 履歴データ     | 部分的欠損         | 段階的補完         |
| 命名規則変遷   | 複数世代の規則混在 | 柔軟なパターン対応 |

## 5. エッジケース・例外処理

### 5.1 データ異常系

| ケース           | 条件               | 期待動作                 |
| ---------------- | ------------------ | ------------------------ |
| 重複文書番号     | 同一番号が既存     | エラー表示・代替番号提案 |
| 無効フォルダパス | 存在しないパス指定 | 警告表示・確認要求       |
| 不正文字列       | パスに使用不可文字 | 自動除去・警告表示       |

### 5.2 ネットワーク異常系

| ケース               | 条件             | 期待動作                   |
| -------------------- | ---------------- | -------------------------- |
| ファイルサーバー不通 | ネットワーク切断 | エラーログ・リトライ       |
| AD認証失敗           | 認証サーバー障害 | ローカル認証フォールバック |
| タイムアウト         | 応答遅延         | タイムアウト設定・再実行   |

### 5.3 ユーザー操作異常系

| ケース         | 条件                     | 期待動作               |
| -------------- | ------------------------ | ---------------------- |
| 権限外アクセス | 機密文書への不正アクセス | アクセス拒否・ログ記録 |
| 不正入力       | SQLインジェクション等    | 入力検証・無害化       |
| 大量データ要求 | 検索結果過多             | ページング・制限       |

## 6. 受け入れ基準

### 6.1 機能受け入れ基準

1. **文書番号生成**: 指定形式での一意番号生成100%成功
2. **検索機能**: 多条件組み合わせ検索で期待結果取得
3. **ファイル確認**: 月次バッチでの存在確認完了
4. **データ移行**: CSV取込み後の名寄せ結果確認

### 6.2 性能受け入れ基準

1. **応答時間**: 検索応答2秒以内を95%以上達成
2. **同時処理**: 10ユーザー同時アクセスでの正常動作
3. **バッチ処理**: 1万件/時間の確認処理達成

### 6.3 セキュリティ受け入れ基準

1. **認証**: AD統合による自動ログイン
2. **認可**: 機密レベル別アクセス制御確認
3. **監査**: 全操作のログ記録確認

## 7. 参考文献

- 既存文書管理規程（社内資料）
- Active Directory設計書（社内資料）
- ネットワークドライブ構成図（社内資料）
- ISO 27001情報セキュリティ管理基準
